# Claude.md - 開発作業ガイドライン

## 🚀 作業開始前の必須確認事項

### 設計書の確認
作業開始時は**必ず**以下の設計書を確認／仕様と異なる点がある場合は更新すること：
- `docs/プログラムアーキテクチャ.md`
- `docs/CosmosDB定義書.md`

**重要**: 憶測での実装は厳禁。設計書に基づいて作業を行う。

## 📋 開発ルール

### コード品質
- **モジュール化**: 1ファイルの肥大化を避ける
- **共通化**: パーツ化・インタフェース定義を適切に行う
- **シンプル**: 複雑すぎる仕組みを避ける
- **影響範囲**: 既存コードの単体改修は避ける（リファクタリングが必要）
- **全体再注意事項**: 
・既存の仕組みを壊さないように注意すること
・一つのファイルが肥大化しないように注意しつつ、処理があっちこっちに実装されてトレースしづらくならないようにすること
・汎用性と可搬性・保守性のすべてを考慮すること

### ブランチ運用
1. **masterブランチでの直接作業は禁止**
2. Issueに対応したFeatureブランチを作成
3. 最新のmasterから`fetch/pull`してからブランチ作成
4. ブランチ名規則: `feature/issue-番号-簡潔な説明`

### 作業フロー
1. **Issue確認**: `gh`コマンドで対象Issueを確認
2. **SOW作成**: `sow/issue-番号-SOW.md`を作成
3. **進捗記録**: SOWと各タスクの進行状況をIssueに投稿
4. **設計反映**: docs/プログラムアーキテクチャ.md、CosmosDB定義書.mdに、非エンジニアでもわかるように、今回修正した箇所がどの機能のどういった処理なのかを記載。
　　　　　　　　　また、上記の資料に、今度はエンジニア二も分かるように記載。
4. **自動完遂**: SOW作成後、ユーザー確認なしでPR発行まで完了

### PR/Issue管理
- `.github/`ディレクトリのテンプレートを必ず使用
- PRには以下を添付：
  - 実装／作業ルールのコピー
  - チェックリスト
  - テスト仕様書の動作確認項目（タスクとして記載）

- 現在実施しているタスクは、明確に別のIssue・別のPRを、といわれない限り、一度作ったIssue・PRを更新し続けること。

## 🎯 Claudeの挙動ルール

作業開始時は以下を必ず出力：

1. 「あ、実装／作業ルールを確認しなきゃ」
2. 実装／作業ルールの内容を表示
3. 以下のメッセージを表示：

```
いいですか？「勝手に判断して間違える」のはやめてください。
・よく見る
・勝手に自分の知識で適当な実装をしない
・AzureとGeminiの音声対話の仕組みが別々になっていて、個別に吸収するのは特殊な仕様がある場合だけ。原則同じ場所で３つの音声対話方式の差異を吸収で切るようにする。

**Remember**: 設計書をよく読み、憶測での実装は避け、ルールに従って着実に作業を進めること。